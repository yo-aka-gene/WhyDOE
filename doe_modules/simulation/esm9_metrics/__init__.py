import numpy as np

from doe_modules.preferences import harmonic_mean


def n_pathways(arr) -> int:
    return np.abs(arr)[:9].sum()


def n_edges(arr) -> int:
    return np.abs(arr)[9:].sum()


def pathway_coverage(arr) -> float:
    full = arr[:9].size
    return n_pathways(arr) / full


def sparse_pathway_coverage(arr):
    return (arr[:9] == 0).sum() / arr[:9].size


def edge_coverage(arr) -> float:
    full = arr[9:].size
    return n_edges(arr) / full


def pathway_positivity(arr):
    n_p = np.abs(arr)[:9].sum()
    return (arr[:9] == 1).sum() / n_p if n_p != 0 else 0


def positive_pathway_coverage(arr):
    return (arr[:9] == 1).sum() / 9



def is_effective(arr):
    return np.array([
        (arr[9] != 0) & (
            (arr[1] != 0) or \
            (arr[(17, 2),] != 0).all() or \
            (arr[(17, 24, 3),] != 0).all() or (arr[(17, 24, 30, 4),] != 0).all() or (arr[(17, 24, 30, 35, 5),] != 0).all() or \
            (arr[(17, 24, 30, 35, 39, 6),] != 0).all() or \
            (arr[(17, 24, 30, 35, 39, 42, 7),] != 0).all() or (arr[(17, 24, 30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(17, 24, 30, 35, 39, 43, 8),] != 0).all() or (arr[(17, 24, 30, 35, 40, 7),] != 0).all() or \
            (arr[(17, 24, 30, 35, 40, 44, 8),] != 0).all() or (arr[(17, 24, 30, 35, 41, 8),] != 0).all() or \
            (arr[(17, 24, 30, 36, 6),] != 0).all() or (arr[(17, 24, 30, 36, 42, 7),] != 0).all() or (arr[(17, 24, 30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(17, 24, 30, 36, 43, 8),] != 0).all() or \
            (arr[(17, 24, 30, 37, 7),] != 0).all() or (arr[(17, 24, 30, 37, 44, 8),] != 0).all() or \
            (arr[(17, 24, 30, 38, 8),] != 0).all() or \
            (arr[(17, 24, 31, 5),] != 0).all() or \
            (arr[(17, 24, 31, 39, 6),] != 0).all() or (arr[(17, 24, 31, 39, 42, 7),] != 0).all() or (arr[(17, 24, 31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(17, 24, 31, 39, 43, 8),] != 0).all() or (arr[(17, 24, 31, 40, 7),] != 0).all() or (arr[(17, 24, 31, 40, 44, 8),] != 0).all() or \
            (arr[(17, 24, 31, 41, 8),] != 0).all() or \
            (arr[(17, 24, 32, 6),] != 0).all() or \
            (arr[(17, 24, 32, 42, 7),] != 0).all() or (arr[(17, 24, 32, 42, 44, 8),] != 0).all() or (arr[(17, 24, 32, 43, 8),] != 0).all() or \
            (arr[(17, 24, 33, 7),] != 0).all() or \
            (arr[(17, 24, 33, 44, 8),] != 0).all() or \
            (arr[(17, 24, 34, 8),] != 0).all() or \
            (arr[(17, 25, 4),] != 0).all() or (arr[(17, 25, 35, 5),] != 0).all() or (arr[(17, 25, 35, 39, 6),] != 0).all() or (arr[(17, 25, 35, 39, 42, 7),] != 0).all() or \
            (arr[(17, 25, 35, 39, 42, 44, 8),] != 0).all() or (arr[(17, 25, 35, 39, 43, 8),] != 0).all() or (arr[(17, 25, 35, 40, 7),] != 0).all() or \
            (arr[(17, 25, 35, 40, 44, 8),] != 0).all() or (arr[(17, 25, 35, 41, 8),] != 0).all() or \
            (arr[(17, 25, 36, 6),] != 0).all() or (arr[(17, 25, 36, 42, 7),] != 0).all() or (arr[(17, 25, 36, 42, 44, 8),] != 0).all() or \
            (arr[(17, 25, 36, 43, 8),] != 0).all() or \
            (arr[(17, 25, 37, 7),] != 0).all() or (arr[(17, 25, 37, 44, 8),] != 0).all() or \
            (arr[(17, 25, 38, 8),] != 0).all() or \
            (arr[(17, 26, 5),] != 0).all() or (arr[(17, 26, 39, 6),] != 0).all() or (arr[(17, 26, 39, 42, 7),] != 0).all() or \
            (arr[(17, 26, 39, 42, 44, 8),] != 0).all() or \
            (arr[(17, 26, 39, 43, 8),] != 0).all() or (arr[(17, 26, 40, 7),] != 0).all() or (arr[(17, 26, 40, 44, 8),] != 0).all() or (arr[(17, 26, 41, 8),] != 0).all() or \
            (arr[(17, 27, 6),] != 0).all() or (arr[(17, 27, 42, 7),] != 0).all() or (arr[(17, 27, 42, 44, 8),] != 0).all() or (arr[(17, 27, 43, 8),] != 0).all() or \
            (arr[(17, 28, 7),] != 0).all() or (arr[(17, 28, 44, 8),] != 0).all() or \
            (arr[(17, 29, 8),] != 0).all() or \
            (arr[(18, 3),] != 0).all() or (arr[(18, 30, 4),] != 0).all() or (arr[(18, 30, 35, 5),] != 0).all() or (arr[(18, 30, 35, 39, 6),] != 0).all() or \
            (arr[(18, 30, 35, 39, 42, 7),] != 0).all() or (arr[(18, 30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(18, 30, 35, 39, 43, 8),] != 0).all() or (arr[(18, 30, 35, 40, 7),] != 0).all() or \
            (arr[(18, 30, 35, 40, 44, 8),] != 0).all() or (arr[(18, 30, 35, 41, 8),] != 0).all() or \
            (arr[(18, 30, 36, 6),] != 0).all() or (arr[(18, 30, 36, 42, 7),] != 0).all() or (arr[(18, 30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(18, 30, 36, 43, 8),] != 0).all() or \
            (arr[(18, 30, 37, 7),] != 0).all() or (arr[(18, 30, 37, 44, 8),] != 0).all() or \
            (arr[(18, 30, 38, 8),] != 0).all() or \
            (arr[(18, 31, 5),] != 0).all() or \
            (arr[(18, 31, 39, 6),] != 0).all() or (arr[(18, 31, 39, 42, 7),] != 0).all() or (arr[(18, 31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(18, 31, 39, 43, 8),] != 0).all() or (arr[(18, 31, 40, 7),] != 0).all() or (arr[(18, 31, 40, 44, 8),] != 0).all() or \
            (arr[(18, 31, 41, 8),] != 0).all() or \
            (arr[(18, 32, 6),] != 0).all() or \
            (arr[(18, 32, 42, 7),] != 0).all() or (arr[(18, 32, 42, 44, 8),] != 0).all() or (arr[(18, 32, 43, 8),] != 0).all() or \
            (arr[(18, 33, 7),] != 0).all() or \
            (arr[(18, 33, 44, 8),] != 0).all() or \
            (arr[(18, 34, 8),] != 0).all() or \
            (arr[(19, 4),] != 0).all() or (arr[(19, 35, 5),] != 0).all() or (arr[(19, 35, 39, 6),] != 0).all() or (arr[(19, 35, 39, 42, 7),] != 0).all() or \
            (arr[(19, 35, 39, 42, 44, 8),] != 0).all() or (arr[(19, 35, 39, 43, 8),] != 0).all() or (arr[(19, 35, 40, 7),] != 0).all() or \
            (arr[(19, 35, 40, 44, 8),] != 0).all() or (arr[(19, 35, 41, 8),] != 0).all() or \
            (arr[(19, 36, 6),] != 0).all() or (arr[(19, 36, 42, 7),] != 0).all() or (arr[(19, 36, 42, 44, 8),] != 0).all() or (arr[(19, 36, 43, 8),] != 0).all() or \
            (arr[(19, 37, 7),] != 0).all() or (arr[(19, 37, 44, 8),] != 0).all() or \
            (arr[(19, 38, 8),] != 0).all() or \
            (arr[(20, 5),] != 0).all() or (arr[(20, 39, 6),] != 0).all() or (arr[(20, 39, 42, 7),] != 0).all() or (arr[(20, 39, 42, 44, 8),] != 0).all() or \
            (arr[(20, 39, 43, 8),] != 0).all() or (arr[(20, 40, 7),] != 0).all() or (arr[(20, 40, 44, 8),] != 0).all() or (arr[(20, 41, 8),] != 0).all() or \
            (arr[(21, 6),] != 0).all() or (arr[(21, 42, 7),] != 0).all() or (arr[(21, 42, 44, 8),] != 0).all() or (arr[(21, 43, 8),] != 0).all() or \
            (arr[(22, 7),] != 0).all() or (arr[(44, 8),] != 0).all() or \
            (arr[(23, 8),] != 0).all()
        ),
        (arr[10] != 0) & (
            (arr[2] != 0) or \
            (arr[(24, 3),] != 0).all() or (arr[(24, 30, 4),] != 0).all() or (arr[(24, 30, 35, 5),] != 0).all() or (arr[(24, 30, 35, 39, 6),] != 0).all() or \
            (arr[(24, 30, 35, 39, 42, 7),] != 0).all() or (arr[(24, 30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(24, 30, 35, 39, 43, 8),] != 0).all() or (arr[(24, 30, 35, 40, 7),] != 0).all() or \
            (arr[(24, 30, 35, 40, 44, 8),] != 0).all() or (arr[(24, 30, 35, 41, 8),] != 0).all() or \
            (arr[(24, 30, 36, 6),] != 0).all() or (arr[(24, 30, 36, 42, 7),] != 0).all() or (arr[(24, 30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(24, 30, 36, 43, 8),] != 0).all() or \
            (arr[(24, 30, 37, 7),] != 0).all() or (arr[(24, 30, 37, 44, 8),] != 0).all() or \
            (arr[(24, 30, 38, 8),] != 0).all() or \
            (arr[(24, 31, 5),] != 0).all() or \
            (arr[(24, 31, 39, 6),] != 0).all() or (arr[(24, 31, 39, 42, 7),] != 0).all() or (arr[(24, 31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(24, 31, 39, 43, 8),] != 0).all() or (arr[(24, 31, 40, 7),] != 0).all() or (arr[(24, 31, 40, 44, 8),] != 0).all() or \
            (arr[(24, 31, 41, 8),] != 0).all() or \
            (arr[(24, 32, 6),] != 0).all() or \
            (arr[(24, 32, 42, 7),] != 0).all() or (arr[(24, 32, 42, 44, 8),] != 0).all() or (arr[(24, 32, 43, 8),] != 0).all() or \
            (arr[(24, 33, 7),] != 0).all() or \
            (arr[(24, 33, 44, 8),] != 0).all() or \
            (arr[(24, 34, 8),] != 0).all() or \
            (arr[(25, 4),] != 0).all() or (arr[(25, 35, 5),] != 0).all() or (arr[(25, 35, 39, 6),] != 0).all() or (arr[(25, 35, 39, 42, 7),] != 0).all() or \
            (arr[(25, 35, 39, 42, 44, 8),] != 0).all() or (arr[(25, 35, 39, 43, 8),] != 0).all() or (arr[(25, 35, 40, 7),] != 0).all() or \
            (arr[(25, 35, 40, 44, 8),] != 0).all() or (arr[(25, 35, 41, 8),] != 0).all() or \
            (arr[(25, 36, 6),] != 0).all() or (arr[(25, 36, 42, 7),] != 0).all() or (arr[(25, 36, 42, 44, 8),] != 0).all() or (arr[(25, 36, 43, 8),] != 0).all() or \
            (arr[(25, 37, 7),] != 0).all() or (arr[(25, 37, 44, 8),] != 0).all() or \
            (arr[(25, 38, 8),] != 0).all() or \
            (arr[(26, 5),] != 0).all() or (arr[(26, 39, 6),] != 0).all() or (arr[(26, 39, 42, 7),] != 0).all() or (arr[(26, 39, 42, 44, 8),] != 0).all() or \
            (arr[(26, 39, 43, 8),] != 0).all() or (arr[(26, 40, 7),] != 0).all() or (arr[(26, 40, 44, 8),] != 0).all() or (arr[(26, 41, 8),] != 0).all() or \
            (arr[(27, 6),] != 0).all() or (arr[(27, 42, 7),] != 0).all() or (arr[(27, 42, 44, 8),] != 0).all() or (arr[(27, 43, 8),] != 0).all() or \
            (arr[(28, 7),] != 0).all() or (arr[(28, 44, 8),] != 0).all() or \
            (arr[(29, 8),] != 0).all()
        ),
        (arr[11] != 0) & (
            (arr[3] != 0) or (arr[(30, 4),] != 0).all() or (arr[(30, 35, 5),] != 0).all() or (arr[(30, 35, 39, 6),] != 0).all() or \
            (arr[(30, 35, 39, 42, 7),] != 0).all() or (arr[(30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(30, 35, 39, 43, 8),] != 0).all() or (arr[(30, 35, 40, 7),] != 0).all() or \
            (arr[(30, 35, 40, 44, 8),] != 0).all() or (arr[(30, 35, 41, 8),] != 0).all() or \
            (arr[(30, 36, 6),] != 0).all() or (arr[(30, 36, 42, 7),] != 0).all() or (arr[(30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(30, 36, 43, 8),] != 0).all() or \
            (arr[(30, 37, 7),] != 0).all() or (arr[(30, 37, 44, 8),] != 0).all() or \
            (arr[(30, 38, 8),] != 0).all() or \
            (arr[(31, 5),] != 0).all() or \
            (arr[(31, 39, 6),] != 0).all() or (arr[(31, 39, 42, 7),] != 0).all() or (arr[(31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(31, 39, 43, 8),] != 0).all() or (arr[(31, 40, 7),] != 0).all() or (arr[(31, 40, 44, 8),] != 0).all() or \
            (arr[(31, 41, 8),] != 0).all() or \
            (arr[(32, 6),] != 0).all() or \
            (arr[(32, 42, 7),] != 0).all() or (arr[(32, 42, 44, 8),] != 0).all() or (arr[(32, 43, 8),] != 0).all() or \
            (arr[(33, 7),] != 0).all() or \
            (arr[(33, 44, 8),] != 0).all() or \
            (arr[(34, 8),] != 0).all()
        ),
        (arr[12] != 0) & (
            (arr[4] != 0) or (arr[(35, 5),] != 0).all() or (arr[(35, 39, 6),] != 0).all() or (arr[(35, 39, 42, 7),] != 0).all() or \
            (arr[(35, 39, 42, 44, 8),] != 0).all() or (arr[(35, 39, 43, 8),] != 0).all() or (arr[(35, 40, 7),] != 0).all() or \
            (arr[(35, 40, 44, 8),] != 0).all() or (arr[(35, 41, 8),] != 0).all() or \
            (arr[(36, 6),] != 0).all() or (arr[(36, 42, 7),] != 0).all() or (arr[(36, 42, 44, 8),] != 0).all() or (arr[(36, 43, 8),] != 0).all() or \
            (arr[(37, 7),] != 0).all() or (arr[(37, 44, 8),] != 0).all() or \
            (arr[(38, 8),] != 0).all()
        ),
        (arr[13] != 0) & (
            (arr[5] != 0) or (arr[(39, 6),] != 0).all() or (arr[(39, 42, 7),] != 0).all() or (arr[(39, 42, 44, 8),] != 0).all() or \
            (arr[(39, 43, 8),] != 0).all() or (arr[(40, 7),] != 0).all() or (arr[(40, 44, 8),] != 0).all() or (arr[(41, 8),] != 0).all()
        ),
        (arr[14] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[15] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[16] != 0) & (arr[8] != 0),
        (arr[17] != 0) & (
            (arr[2] != 0) or \
            (arr[(24, 3),] != 0).all() or (arr[(24, 30, 4),] != 0).all() or (arr[(24, 30, 35, 5),] != 0).all() or (arr[(24, 30, 35, 39, 6),] != 0).all() or \
            (arr[(24, 30, 35, 39, 42, 7),] != 0).all() or (arr[(24, 30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(24, 30, 35, 39, 43, 8),] != 0).all() or (arr[(24, 30, 35, 40, 7),] != 0).all() or \
            (arr[(24, 30, 35, 40, 44, 8),] != 0).all() or (arr[(24, 30, 35, 41, 8),] != 0).all() or \
            (arr[(24, 30, 36, 6),] != 0).all() or (arr[(24, 30, 36, 42, 7),] != 0).all() or (arr[(24, 30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(24, 30, 36, 43, 8),] != 0).all() or \
            (arr[(24, 30, 37, 7),] != 0).all() or (arr[(24, 30, 37, 44, 8),] != 0).all() or \
            (arr[(24, 30, 38, 8),] != 0).all() or \
            (arr[(24, 31, 5),] != 0).all() or \
            (arr[(24, 31, 39, 6),] != 0).all() or (arr[(24, 31, 39, 42, 7),] != 0).all() or (arr[(24, 31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(24, 31, 39, 43, 8),] != 0).all() or (arr[(24, 31, 40, 7),] != 0).all() or (arr[(24, 31, 40, 44, 8),] != 0).all() or \
            (arr[(24, 31, 41, 8),] != 0).all() or \
            (arr[(24, 32, 6),] != 0).all() or \
            (arr[(24, 32, 42, 7),] != 0).all() or (arr[(24, 32, 42, 44, 8),] != 0).all() or (arr[(24, 32, 43, 8),] != 0).all() or \
            (arr[(24, 33, 7),] != 0).all() or \
            (arr[(24, 33, 44, 8),] != 0).all() or \
            (arr[(24, 34, 8),] != 0).all() or \
            (arr[(25, 4),] != 0).all() or (arr[(25, 35, 5),] != 0).all() or (arr[(25, 35, 39, 6),] != 0).all() or (arr[(25, 35, 39, 42, 7),] != 0).all() or \
            (arr[(25, 35, 39, 42, 44, 8),] != 0).all() or (arr[(25, 35, 39, 43, 8),] != 0).all() or (arr[(25, 35, 40, 7),] != 0).all() or \
            (arr[(25, 35, 40, 44, 8),] != 0).all() or (arr[(25, 35, 41, 8),] != 0).all() or \
            (arr[(25, 36, 6),] != 0).all() or (arr[(25, 36, 42, 7),] != 0).all() or (arr[(25, 36, 42, 44, 8),] != 0).all() or (arr[(25, 36, 43, 8),] != 0).all() or \
            (arr[(25, 37, 7),] != 0).all() or (arr[(25, 37, 44, 8),] != 0).all() or \
            (arr[(25, 38, 8),] != 0).all() or \
            (arr[(26, 5),] != 0).all() or (arr[(26, 39, 6),] != 0).all() or (arr[(26, 39, 42, 7),] != 0).all() or (arr[(26, 39, 42, 44, 8),] != 0).all() or \
            (arr[(26, 39, 43, 8),] != 0).all() or (arr[(26, 40, 7),] != 0).all() or (arr[(26, 40, 44, 8),] != 0).all() or (arr[(26, 41, 8),] != 0).all() or \
            (arr[(27, 6),] != 0).all() or (arr[(27, 42, 7),] != 0).all() or (arr[(27, 42, 44, 8),] != 0).all() or (arr[(27, 43, 8),] != 0).all() or \
            (arr[(28, 7),] != 0).all() or (arr[(28, 44, 8),] != 0).all() or \
            (arr[(29, 8),] != 0).all()
        ),
        (arr[18] != 0) & (
            (arr[3] != 0) or (arr[(30, 4),] != 0).all() or (arr[(30, 35, 5),] != 0).all() or (arr[(30, 35, 39, 6),] != 0).all() or \
            (arr[(30, 35, 39, 42, 7),] != 0).all() or (arr[(30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(30, 35, 39, 43, 8),] != 0).all() or (arr[(30, 35, 40, 7),] != 0).all() or \
            (arr[(30, 35, 40, 44, 8),] != 0).all() or (arr[(30, 35, 41, 8),] != 0).all() or \
            (arr[(30, 36, 6),] != 0).all() or (arr[(30, 36, 42, 7),] != 0).all() or (arr[(30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(30, 36, 43, 8),] != 0).all() or \
            (arr[(30, 37, 7),] != 0).all() or (arr[(30, 37, 44, 8),] != 0).all() or \
            (arr[(30, 38, 8),] != 0).all() or \
            (arr[(31, 5),] != 0).all() or \
            (arr[(31, 39, 6),] != 0).all() or (arr[(31, 39, 42, 7),] != 0).all() or (arr[(31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(31, 39, 43, 8),] != 0).all() or (arr[(31, 40, 7),] != 0).all() or (arr[(31, 40, 44, 8),] != 0).all() or \
            (arr[(31, 41, 8),] != 0).all() or \
            (arr[(32, 6),] != 0).all() or \
            (arr[(32, 42, 7),] != 0).all() or (arr[(32, 42, 44, 8),] != 0).all() or (arr[(32, 43, 8),] != 0).all() or \
            (arr[(33, 7),] != 0).all() or \
            (arr[(33, 44, 8),] != 0).all() or \
            (arr[(34, 8),] != 0).all()
        ),
        (arr[19] != 0) & (
            (arr[4] != 0) or (arr[(35, 5),] != 0).all() or (arr[(35, 39, 6),] != 0).all() or (arr[(35, 39, 42, 7),] != 0).all() or \
            (arr[(35, 39, 42, 44, 8),] != 0).all() or (arr[(35, 39, 43, 8),] != 0).all() or (arr[(35, 40, 7),] != 0).all() or \
            (arr[(35, 40, 44, 8),] != 0).all() or (arr[(35, 41, 8),] != 0).all() or \
            (arr[(36, 6),] != 0).all() or (arr[(36, 42, 7),] != 0).all() or (arr[(36, 42, 44, 8),] != 0).all() or (arr[(36, 43, 8),] != 0).all() or \
            (arr[(37, 7),] != 0).all() or (arr[(37, 44, 8),] != 0).all() or \
            (arr[(38, 8),] != 0).all()
        ),
        (arr[20] != 0) & (
            (arr[5] != 0) or (arr[(39, 6),] != 0).all() or (arr[(39, 42, 7),] != 0).all() or (arr[(39, 42, 44, 8),] != 0).all() or \
            (arr[(39, 43, 8),] != 0).all() or (arr[(40, 7),] != 0).all() or (arr[(40, 44, 8),] != 0).all() or (arr[(41, 8),] != 0).all()
        ),
        (arr[21] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[22] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[23] != 0) & (arr[8] != 0),
        (arr[24] != 0) & (
            (arr[3] != 0) or (arr[(30, 4),] != 0).all() or (arr[(30, 35, 5),] != 0).all() or (arr[(30, 35, 39, 6),] != 0).all() or \
            (arr[(30, 35, 39, 42, 7),] != 0).all() or (arr[(30, 35, 39, 42, 44, 8),] != 0).all() or \
            (arr[(30, 35, 39, 43, 8),] != 0).all() or (arr[(30, 35, 40, 7),] != 0).all() or \
            (arr[(30, 35, 40, 44, 8),] != 0).all() or (arr[(30, 35, 41, 8),] != 0).all() or \
            (arr[(30, 36, 6),] != 0).all() or (arr[(30, 36, 42, 7),] != 0).all() or (arr[(30, 36, 42, 44, 8),] != 0).all() or \
            (arr[(30, 36, 43, 8),] != 0).all() or \
            (arr[(30, 37, 7),] != 0).all() or (arr[(30, 37, 44, 8),] != 0).all() or \
            (arr[(30, 38, 8),] != 0).all() or \
            (arr[(31, 5),] != 0).all() or \
            (arr[(31, 39, 6),] != 0).all() or (arr[(31, 39, 42, 7),] != 0).all() or (arr[(31, 39, 42, 44, 8),] != 0).all() or \
            (arr[(31, 39, 43, 8),] != 0).all() or (arr[(31, 40, 7),] != 0).all() or (arr[(31, 40, 44, 8),] != 0).all() or \
            (arr[(31, 41, 8),] != 0).all() or \
            (arr[(32, 6),] != 0).all() or \
            (arr[(32, 42, 7),] != 0).all() or (arr[(32, 42, 44, 8),] != 0).all() or (arr[(32, 43, 8),] != 0).all() or \
            (arr[(33, 7),] != 0).all() or \
            (arr[(33, 44, 8),] != 0).all() or \
            (arr[(34, 8),] != 0).all()
        ),
        (arr[25] != 0) & (
            (arr[4] != 0) or (arr[(35, 5),] != 0).all() or (arr[(35, 39, 6),] != 0).all() or (arr[(35, 39, 42, 7),] != 0).all() or \
            (arr[(35, 39, 42, 44, 8),] != 0).all() or (arr[(35, 39, 43, 8),] != 0).all() or (arr[(35, 40, 7),] != 0).all() or \
            (arr[(35, 40, 44, 8),] != 0).all() or (arr[(35, 41, 8),] != 0).all() or \
            (arr[(36, 6),] != 0).all() or (arr[(36, 42, 7),] != 0).all() or (arr[(36, 42, 44, 8),] != 0).all() or (arr[(36, 43, 8),] != 0).all() or \
            (arr[(37, 7),] != 0).all() or (arr[(37, 44, 8),] != 0).all() or \
            (arr[(38, 8),] != 0).all()
        ),
        (arr[26] != 0) & (
            (arr[5] != 0) or (arr[(39, 6),] != 0).all() or (arr[(39, 42, 7),] != 0).all() or (arr[(39, 42, 44, 8),] != 0).all() or \
            (arr[(39, 43, 8),] != 0).all() or (arr[(40, 7),] != 0).all() or (arr[(40, 44, 8),] != 0).all() or (arr[(41, 8),] != 0).all()
        ),
        (arr[27] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[28] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[29] != 0) & (arr[8] != 0),
        (arr[30] != 0) & (
            (arr[4] != 0) or (arr[(35, 5),] != 0).all() or (arr[(35, 39, 6),] != 0).all() or (arr[(35, 39, 42, 7),] != 0).all() or \
            (arr[(35, 39, 42, 44, 8),] != 0).all() or (arr[(35, 39, 43, 8),] != 0).all() or (arr[(35, 40, 7),] != 0).all() or \
            (arr[(35, 40, 44, 8),] != 0).all() or (arr[(35, 41, 8),] != 0).all() or \
            (arr[(36, 6),] != 0).all() or (arr[(36, 42, 7),] != 0).all() or (arr[(36, 42, 44, 8),] != 0).all() or (arr[(36, 43, 8),] != 0).all() or \
            (arr[(37, 7),] != 0).all() or (arr[(37, 44, 8),] != 0).all() or \
            (arr[(38, 8),] != 0).all()
        ),
        (arr[31] != 0) & (
            (arr[5] != 0) or (arr[(39, 6),] != 0).all() or (arr[(39, 42, 7),] != 0).all() or (arr[(39, 42, 44, 8),] != 0).all() or \
            (arr[(39, 43, 8),] != 0).all() or (arr[(40, 7),] != 0).all() or (arr[(40, 44, 8),] != 0).all() or (arr[(41, 8),] != 0).all()
        ),
        (arr[32] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[33] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[34] != 0) & (arr[8] != 0),
        (arr[35] != 0) & (
            (arr[5] != 0) or (arr[(39, 6),] != 0).all() or (arr[(39, 42, 7),] != 0).all() or (arr[(39, 42, 44, 8),] != 0).all() or \
            (arr[(39, 43, 8),] != 0).all() or (arr[(40, 7),] != 0).all() or (arr[(40, 44, 8),] != 0).all() or (arr[(41, 8),] != 0).all()
        ),
        (arr[36] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[37] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[38] != 0) & (arr[8] != 0),
        (arr[39] != 0) & ((arr[6] != 0) or (arr[(42, 7),] != 0).all() or (arr[(42, 44, 8),] != 0).all() or (arr[(43, 8),] != 0).all()),
        (arr[40] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[41] != 0) & (arr[8] != 0),
        (arr[42] != 0) & ((arr[7] != 0) or (arr[(44, 8),] != 0).all()),
        (arr[43] != 0) & (arr[8] != 0),
        (arr[44] != 0) & (arr[8] != 0),
    ])


def n_eff(arr):
    return is_effective(arr).sum()


def n_effpos(arr):
    return ((arr[9:] == 1) & is_effective(arr)).sum()


def effective_edge_positivity(arr):
    return n_effpos(arr) / n_eff(arr) if n_eff(arr) != 0 else 0


def positive_edge_loading(arr):
    return (arr[:9] == 1) * np.array([
        0,
        (arr[(9),] == 1).sum(),
        (
            (arr[(10, 17),] == 1).sum() + \
            (arr[(9, 17),] == 1).all()
        ),
        (
            (arr[(11, 18, 24),] == 1).sum() + \
            (arr[(10, 24),] == 1).all() + (arr[(17, 24),] == 1).all() + \
            ((arr[(9, 18),] == 1).all() or (arr[(9, 17, 24),] == 1).all())
        ),
        (
            (arr[(12, 19, 25, 30),] == 1).sum() + \
            (arr[(11, 30),] == 1).all() + (arr[(18, 30),] == 1).all() + (arr[(24, 30),] == 1).all() + \
            ((arr[(10, 25),] == 1).all() or (arr[(10, 24, 30),] == 1).all()) + \
            ((arr[(17, 25),] == 1).all() or (arr[(17, 24, 30),] == 1).all()) + \
            ((arr[(9, 19),] == 1).all() or (arr[(9, 18, 30),] == 1).all() or (arr[(9, 17, 25),] == 1).all() or (arr[(9, 17, 24, 30),] == 1).all())
        ),
        (
            (arr[(13, 20, 26, 31, 35),] == 1).sum() + \
            (arr[(12, 35),] == 1).all() + (arr[(19, 35),] == 1).all() + (arr[(25, 35),] == 1).all() + (arr[(30, 35),] == 1).all() + \
            ((arr[(11, 31),] == 1).all() or (arr[(11, 30, 35),] == 1).all()) + \
            ((arr[(18, 31),] == 1).all() or (arr[(18, 30, 35),] == 1).all()) + \
            ((arr[(24, 31),] == 1).all() or (arr[(24, 30, 35),] == 1).all()) + \
            ((arr[(10, 26),] == 1).all() or (arr[(10, 25, 35),] == 1).all() or (arr[(10, 24, 31),] == 1).all() or (arr[(10, 24, 30, 35),] == 1).all()) + \
            ((arr[(17, 26),] == 1).all() or (arr[(17, 25, 35),] == 1).all() or (arr[(17, 24, 31),] == 1).all() or (arr[(17, 24, 30, 35),] == 1).all()) + \
            (
                (arr[(9, 20),] == 1).all() or (arr[(9, 19, 35),] == 1).all() or (arr[(9, 18, 31),] == 1).all() or (arr[(9, 18, 30, 35),] == 1).all() or \
                (arr[(9, 17, 26),] == 1).all() or (arr[(9, 17, 25, 35),] == 1).all() or (arr[(9, 17, 24, 31),] == 1).all() or (arr[(9, 17, 24, 30, 35),] == 1).all()
            )
        ),
        (
            (arr[(14, 21, 27, 32, 36, 39),] == 1).sum() + \
            (arr[(13, 39),] == 1).all() + (arr[(20, 39),] == 1).all() + (arr[(26, 39),] == 1).all() + (arr[(31, 39),] == 1).all() + (arr[(35, 39),] == 1).all() + \
            ((arr[(12, 36),] == 1).all() or (arr[(12, 35, 39),] == 1).all()) + \
            ((arr[(19, 36),] == 1).all() or (arr[(19, 35, 39),] == 1).all()) + \
            ((arr[(25, 36),] == 1).all() or (arr[(25, 35, 39),] == 1).all()) + \
            ((arr[(30, 36),] == 1).all() or (arr[(30, 35, 39),] == 1).all()) + \
            ((arr[(11, 32),] == 1).all() or (arr[(11, 31, 39),] == 1).all() or (arr[(11, 30, 36),] == 1).all() or (arr[(11, 30, 35, 39),] == 1).all()) + \
            ((arr[(18, 32),] == 1).all() or (arr[(18, 31, 39),] == 1).all() or (arr[(18, 30, 36),] == 1).all() or (arr[(18, 30, 35, 39),] == 1).all()) + \
            ((arr[(24, 32),] == 1).all() or (arr[(24, 31, 39),] == 1).all() or (arr[(24, 30, 36),] == 1).all() or (arr[(24, 30, 35, 39),] == 1).all()) + \
            (
                (arr[(10, 27),] == 1).all() or (arr[(10, 26, 39),] == 1).all() or (arr[(10, 25, 36),] == 1).all() or (arr[(10, 25, 35, 39),] == 1).all() or \
                (arr[(10, 24, 32),] == 1).all() or (arr[(10, 24, 31, 39),] == 1).all() or (arr[(10, 24, 30, 36),] == 1).all() or (arr[(10, 24, 30, 35, 39),] == 1).all()
            ) + \
            (
                (arr[(17, 27),] == 1).all() or (arr[(17, 26, 39),] == 1).all() or (arr[(17, 25, 36),] == 1).all() or (arr[(17, 25, 35, 39),] == 1).all() or \
                (arr[(17, 24, 32),] == 1).all() or (arr[(17, 24, 31, 39),] == 1).all() or (arr[(17, 24, 30, 36),] == 1).all() or (arr[(17, 24, 30, 35, 39),] == 1).all()
            ) + \
            (
                (arr[(9, 21),] == 1).all() or (arr[(9, 20, 39),] == 1).all() or (arr[(9, 19, 36),] == 1).all() or (arr[(9, 19, 35, 39),] == 1).all() or \
                (arr[(9, 18, 32),] == 1).all() or (arr[(9, 18, 31, 39),] == 1).all() or (arr[(9, 18, 30, 36),] == 1).all() or (arr[(9, 18, 30, 35, 39),] == 1).all() or \
                (arr[(9, 17, 27),] == 1).all() or (arr[(9, 17, 26, 39),] == 1).all() or (arr[(9, 17, 25, 36),] == 1).all() or (arr[(9, 17, 25, 35, 39),] == 1).all() or \
                (arr[(9, 17, 24, 32),] == 1).all() or (arr[(9, 17, 24, 31, 39),] == 1).all() or (arr[(9, 17, 24, 30, 36),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39),] == 1).all()
            )
        ),
        (
            (arr[(15, 22, 28, 33, 37, 40, 42),] == 1).sum() + \
            (arr[(14, 42),] == 1).all() + (arr[(21, 42),] == 1).all() + (arr[(27, 42),] == 1).all() + (arr[(32, 42),] == 1).all() + (arr[(36, 42),] == 1).all() + (arr[(39, 42),] == 1).all() + \
            ((arr[(13, 40),] == 1).all() or (arr[(13, 39, 42),] == 1).all()) + \
            ((arr[(20, 40),] == 1).all() or (arr[(20, 39, 42),] == 1).all()) + \
            ((arr[(26, 40),] == 1).all() or (arr[(26, 39, 42),] == 1).all()) + \
            ((arr[(31, 40),] == 1).all() or (arr[(31, 39, 42),] == 1).all()) + \
            ((arr[(35, 40),] == 1).all() or (arr[(35, 39, 42),] == 1).all()) + \
            ((arr[(12, 37),] == 1).all() or (arr[(12, 36, 42),] == 1).all() or (arr[(12, 35, 40),] == 1).all() or (arr[(12, 35, 39, 42),] == 1).all()) + \
            ((arr[(19, 37),] == 1).all() or (arr[(19, 36, 42),] == 1).all() or (arr[(19, 35, 40),] == 1).all() or (arr[(19, 35, 39, 42),] == 1).all()) + \
            ((arr[(25, 37),] == 1).all() or (arr[(25, 36, 42),] == 1).all() or (arr[(25, 35, 40),] == 1).all() or (arr[(25, 35, 39, 42),] == 1).all()) + \
            ((arr[(30, 37),] == 1).all() or (arr[(30, 36, 42),] == 1).all() or (arr[(30, 35, 40),] == 1).all() or (arr[(30, 35, 39, 42),] == 1).all()) + \
            (
                (arr[(11, 33),] == 1).all() or (arr[(11, 32, 42),] == 1).all() or (arr[(11, 31, 40),] == 1).all() or (arr[(11, 31, 39, 42),] == 1).all() or \
                (arr[(11, 30, 37),] == 1).all() or (arr[(11, 30, 36, 42),] == 1).all() or (arr[(11, 30, 35, 40),] == 1).all() or (arr[(11, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(18, 33),] == 1).all() or (arr[(18, 32, 42),] == 1).all() or (arr[(18, 31, 40),] == 1).all() or (arr[(18, 31, 39, 42),] == 1).all() or \
                (arr[(18, 30, 37),] == 1).all() or (arr[(18, 30, 36, 42),] == 1).all() or (arr[(18, 30, 35, 40),] == 1).all() or (arr[(18, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(24, 33),] == 1).all() or (arr[(24, 32, 42),] == 1).all() or (arr[(24, 31, 40),] == 1).all() or (arr[(24, 31, 39, 42),] == 1).all() or \
                (arr[(24, 30, 37),] == 1).all() or (arr[(24, 30, 36, 42),] == 1).all() or (arr[(24, 30, 35, 40),] == 1).all() or (arr[(24, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(10, 28),] == 1).all() or (arr[(10, 27, 42),] == 1).all() or (arr[(10, 26, 40),] == 1).all() or (arr[(10, 26, 39, 42),] == 1).all() or \
                (arr[(10, 25, 37),] == 1).all() or (arr[(10, 25, 36, 42),] == 1).all() or (arr[(10, 25, 35, 40),] == 1).all() or (arr[(10, 25, 35, 39, 42),] == 1).all() or \
                (arr[(10, 24, 33),] == 1).all() or (arr[(10, 24, 32, 42),] == 1).all() or (arr[(10, 24, 31, 40),] == 1).all() or (arr[(10, 24, 31, 39, 42),] == 1).all() or \
                (arr[(10, 24, 30, 37),] == 1).all() or (arr[(10, 24, 30, 36, 42),] == 1).all() or (arr[(10, 24, 30, 35, 40),] == 1).all() or (arr[(10, 24, 30, 35, 39, 42),] == 1).all()
            ) + \
             (
                (arr[(17, 28),] == 1).all() or (arr[(17, 27, 42),] == 1).all() or (arr[(17, 26, 40),] == 1).all() or (arr[(17, 26, 39, 42),] == 1).all() or \
                (arr[(17, 25, 37),] == 1).all() or (arr[(17, 25, 36, 42),] == 1).all() or (arr[(17, 25, 35, 40),] == 1).all() or (arr[(17, 25, 35, 39, 42),] == 1).all() or \
                (arr[(17, 24, 33),] == 1).all() or (arr[(17, 24, 32, 42),] == 1).all() or (arr[(17, 24, 31, 40),] == 1).all() or (arr[(17, 24, 31, 39, 42),] == 1).all() or \
                (arr[(17, 24, 30, 37),] == 1).all() or (arr[(17, 24, 30, 36, 42),] == 1).all() or (arr[(17, 24, 30, 35, 40),] == 1).all() or (arr[(17, 24, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(9, 22),] == 1).all() or (arr[(9, 21, 42),] == 1).all() or (arr[(9, 20, 40),] == 1).all() or (arr[(9, 20, 39, 42),] == 1).all() or \
                (arr[(9, 19, 37),] == 1).all() or (arr[(9, 19, 36, 42),] == 1).all() or (arr[(9, 19, 35, 40),] == 1).all() or (arr[(9, 19, 35, 39, 42),] == 1).all() or \
                (arr[(9, 18, 33),] == 1).all() or (arr[(9, 18, 32, 42),] == 1).all() or (arr[(9, 18, 31, 40),] == 1).all() or (arr[(9, 18, 31, 39, 42),] == 1).all() or \
                (arr[(9, 18, 30, 37),] == 1).all() or (arr[(9, 18, 30, 36, 42),] == 1).all() or (arr[(9, 18, 30, 35, 40),] == 1).all() or (arr[(9, 18, 30, 35, 39, 42),] == 1).all() or \
                (arr[(9, 17, 28),] == 1).all() or (arr[(9, 17, 27, 42),] == 1).all() or (arr[(9, 17, 26, 40),] == 1).all() or (arr[(9, 17, 26, 39, 42),] == 1).all() or \
                (arr[(9, 17, 25, 37),] == 1).all() or (arr[(9, 17, 25, 36, 42),] == 1).all() or (arr[(9, 17, 25, 35, 40),] == 1).all() or (arr[(9, 17, 25, 35, 39, 42),] == 1).all() or \
                (arr[(9, 17, 24, 33),] == 1).all() or (arr[(9, 17, 24, 32, 42),] == 1).all() or (arr[(9, 17, 24, 31, 40),] == 1).all() or (arr[(9, 17, 24, 31, 39, 42),] == 1).all() or \
                (arr[(9, 17, 24, 30, 37),] == 1).all() or (arr[(9, 17, 24, 30, 36, 42),] == 1).all() or (arr[(9, 17, 24, 30, 35, 40),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 42),] == 1).all()
            )
        ),
        (
            (arr[(16, 23, 29, 34, 38, 41, 43, 44),] == 1).sum() + \
            (arr[(15, 44),] == 1).all() + (arr[(22, 44),] == 1).all() + (arr[(28, 44),] == 1).all() + (arr[(33, 44),] == 1).all() + \
            (arr[(37, 44),] == 1).all() + (arr[(40, 44),] == 1).all() + (arr[(42, 44),] == 1).all() + \
            ((arr[(14, 43),] == 1).all() or (arr[(14, 42, 44),] == 1).all()) + \
            ((arr[(21, 43),] == 1).all() or (arr[(21, 42, 44),] == 1).all()) + \
            ((arr[(27, 43),] == 1).all() or (arr[(27, 42, 44),] == 1).all()) + \
            ((arr[(32, 43),] == 1).all() or (arr[(32, 42, 44),] == 1).all()) + \
            ((arr[(36, 43),] == 1).all() or (arr[(36, 42, 44),] == 1).all()) + \
            ((arr[(39, 43),] == 1).all() or (arr[(39, 42, 44),] == 1).all()) + \
            ((arr[(13, 41),] == 1).all() or (arr[(13, 40, 44),] == 1).all() or (arr[(13, 39, 43),] == 1).all() or (arr[(13, 39, 42, 44),] == 1).all()) + \
            ((arr[(20, 41),] == 1).all() or (arr[(20, 40, 44),] == 1).all() or (arr[(20, 39, 43),] == 1).all() or (arr[(20, 39, 42, 44),] == 1).all()) + \
            ((arr[(26, 41),] == 1).all() or (arr[(26, 40, 44),] == 1).all() or (arr[(26, 39, 43),] == 1).all() or (arr[(26, 39, 42, 44),] == 1).all()) + \
            ((arr[(31, 41),] == 1).all() or (arr[(31, 40, 44),] == 1).all() or (arr[(31, 39, 43),] == 1).all() or (arr[(31, 39, 42, 44),] == 1).all()) + \
            ((arr[(35, 41),] == 1).all() or (arr[(35, 40, 44),] == 1).all() or (arr[(35, 39, 43),] == 1).all() or (arr[(35, 39, 42, 44),] == 1).all()) + \
            (
                (arr[(12, 38),] == 1).all() or (arr[(12, 37, 44),] == 1).all() or (arr[(12, 36, 43),] == 1).all() or (arr[(12, 36, 42, 44),] == 1).all() or \
                (arr[(12, 35, 41),] == 1).all() or (arr[(12, 35, 40, 44),] == 1).all() or (arr[(12, 35, 39, 43),] == 1).all() or (arr[(12, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(19, 38),] == 1).all() or (arr[(19, 37, 44),] == 1).all() or (arr[(19, 36, 43),] == 1).all() or (arr[(19, 36, 42, 44),] == 1).all() or \
                (arr[(19, 35, 41),] == 1).all() or (arr[(19, 35, 40, 44),] == 1).all() or (arr[(19, 35, 39, 43),] == 1).all() or (arr[(19, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(25, 38),] == 1).all() or (arr[(25, 37, 44),] == 1).all() or (arr[(25, 36, 43),] == 1).all() or (arr[(25, 36, 42, 44),] == 1).all() or \
                (arr[(25, 35, 41),] == 1).all() or (arr[(25, 35, 40, 44),] == 1).all() or (arr[(25, 35, 39, 43),] == 1).all() or (arr[(25, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(30, 38),] == 1).all() or (arr[(30, 37, 44),] == 1).all() or (arr[(30, 36, 43),] == 1).all() or (arr[(30, 36, 42, 44),] == 1).all() or \
                (arr[(30, 35, 41),] == 1).all() or (arr[(30, 35, 40, 44),] == 1).all() or (arr[(30, 35, 39, 43),] == 1).all() or (arr[(30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(11, 34),] == 1).all() or (arr[(11, 33, 44),] == 1).all() or (arr[(11, 32, 43),] == 1).all() or (arr[(11, 32, 42, 44),] == 1).all() or \
                (arr[(11, 31, 41),] == 1).all() or (arr[(11, 31, 40, 44),] == 1).all() or (arr[(11, 31, 39, 43),] == 1).all() or (arr[(11, 31, 39, 42, 44),] == 1).all() or \
                (arr[(11, 30, 38),] == 1).all() or (arr[(11, 30, 37, 44),] == 1).all() or (arr[(11, 30, 36, 43),] == 1).all() or (arr[(11, 30, 36, 42, 44),] == 1).all() or \
                (arr[(11, 30, 35, 41),] == 1).all() or (arr[(11, 30, 35, 40, 44),] == 1).all() or (arr[(11, 30, 35, 39, 43),] == 1).all() or (arr[(11, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(18, 34),] == 1).all() or (arr[(18, 33, 44),] == 1).all() or (arr[(18, 32, 43),] == 1).all() or (arr[(18, 32, 42, 44),] == 1).all() or \
                (arr[(18, 31, 41),] == 1).all() or (arr[(18, 31, 40, 44),] == 1).all() or (arr[(18, 31, 39, 43),] == 1).all() or (arr[(18, 31, 39, 42, 44),] == 1).all() or \
                (arr[(18, 30, 38),] == 1).all() or (arr[(18, 30, 37, 44),] == 1).all() or (arr[(18, 30, 36, 43),] == 1).all() or (arr[(18, 30, 36, 42, 44),] == 1).all() or \
                (arr[(18, 30, 35, 41),] == 1).all() or (arr[(18, 30, 35, 40, 44),] == 1).all() or (arr[(18, 30, 35, 39, 43),] == 1).all() or (arr[(18, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(24, 34),] == 1).all() or (arr[(24, 33, 44),] == 1).all() or (arr[(24, 32, 43),] == 1).all() or (arr[(24, 32, 42, 44),] == 1).all() or \
                (arr[(24, 31, 41),] == 1).all() or (arr[(24, 31, 40, 44),] == 1).all() or (arr[(24, 31, 39, 43),] == 1).all() or (arr[(24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(24, 30, 38),] == 1).all() or (arr[(24, 30, 37, 44),] == 1).all() or (arr[(24, 30, 36, 43),] == 1).all() or (arr[(24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(24, 30, 35, 41),] == 1).all() or (arr[(24, 30, 35, 40, 44),] == 1).all() or (arr[(24, 30, 35, 39, 43),] == 1).all() or (arr[(24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(10, 29),] == 1).all() or (arr[(10, 28, 44),] == 1).all() or (arr[(10, 27, 43),] == 1).all() or (arr[(10, 27, 42, 44),] == 1).all() or \
                (arr[(10, 26, 41),] == 1).all() or (arr[(10, 26, 40, 44),] == 1).all() or (arr[(10, 26, 39, 43),] == 1).all() or (arr[(10, 26, 39, 42, 44),] == 1).all() or \
                (arr[(10, 25, 38),] == 1).all() or (arr[(10, 25, 37, 44),] == 1).all() or (arr[(10, 25, 36, 43),] == 1).all() or (arr[(10, 25, 36, 42, 44),] == 1).all() or \
                (arr[(10, 25, 35, 41),] == 1).all() or (arr[(10, 25, 35, 40, 44),] == 1).all() or (arr[(10, 25, 35, 39, 43),] == 1).all() or (arr[(10, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(10, 24, 34),] == 1).all() or (arr[(10, 24, 33, 44),] == 1).all() or (arr[(10, 24, 32, 43),] == 1).all() or (arr[(10, 24, 32, 42, 44),] == 1).all() or \
                (arr[(10, 24, 31, 41),] == 1).all() or (arr[(10, 24, 31, 40, 44),] == 1).all() or (arr[(10, 24, 31, 39, 43),] == 1).all() or (arr[(10, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(10, 24, 30, 38),] == 1).all() or (arr[(10, 24, 30, 37, 44),] == 1).all() or (arr[(10, 24, 30, 36, 43),] == 1).all() or (arr[(10, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(10, 24, 30, 35, 41),] == 1).all() or (arr[(10, 24, 30, 35, 40, 44),] == 1).all() or (arr[(10, 24, 30, 35, 39, 43),] == 1).all() or (arr[(10, 24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(17, 29),] == 1).all() or (arr[(17, 28, 44),] == 1).all() or (arr[(17, 27, 43),] == 1).all() or (arr[(17, 27, 42, 44),] == 1).all() or \
                (arr[(17, 26, 41),] == 1).all() or (arr[(17, 26, 40, 44),] == 1).all() or (arr[(17, 26, 39, 43),] == 1).all() or (arr[(17, 26, 39, 42, 44),] == 1).all() or \
                (arr[(17, 25, 38),] == 1).all() or (arr[(17, 25, 37, 44),] == 1).all() or (arr[(17, 25, 36, 43),] == 1).all() or (arr[(17, 25, 36, 42, 44),] == 1).all() or \
                (arr[(17, 25, 35, 41),] == 1).all() or (arr[(17, 25, 35, 40, 44),] == 1).all() or (arr[(17, 25, 35, 39, 43),] == 1).all() or (arr[(17, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(17, 24, 34),] == 1).all() or (arr[(17, 24, 33, 44),] == 1).all() or (arr[(17, 24, 32, 43),] == 1).all() or (arr[(17, 24, 32, 42, 44),] == 1).all() or \
                (arr[(17, 24, 31, 41),] == 1).all() or (arr[(17, 24, 31, 40, 44),] == 1).all() or (arr[(17, 24, 31, 39, 43),] == 1).all() or (arr[(17, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(17, 24, 30, 38),] == 1).all() or (arr[(17, 24, 30, 37, 44),] == 1).all() or (arr[(17, 24, 30, 36, 43),] == 1).all() or (arr[(17, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(17, 24, 30, 35, 41),] == 1).all() or (arr[(17, 24, 30, 35, 40, 44),] == 1).all() or (arr[(17, 24, 30, 35, 39, 43),] == 1).all() or (arr[(17, 24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(9, 23),] == 1).all() or (arr[(9, 22, 44),] == 1).all() or (arr[(9, 21, 43),] == 1).all() or (arr[(9, 21, 42, 44),] == 1).all() or \
                (arr[(9, 20, 41),] == 1).all() or (arr[(9, 20, 40, 44),] == 1).all() or (arr[(9, 20, 39, 43),] == 1).all() or (arr[(9, 20, 39, 42, 44),] == 1).all() or \
                (arr[(9, 19, 38),] == 1).all() or (arr[(9, 19, 37, 44),] == 1).all() or (arr[(9, 19, 36, 43),] == 1).all() or (arr[(9, 19, 36, 42, 44),] == 1).all() or \
                (arr[(9, 19, 35, 41),] == 1).all() or (arr[(9, 19, 35, 40, 44),] == 1).all() or (arr[(9, 19, 35, 39, 43),] == 1).all() or (arr[(9, 19, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 18, 34),] == 1).all() or (arr[(9, 18, 33, 44),] == 1).all() or (arr[(9, 18, 32, 43),] == 1).all() or (arr[(9, 18, 32, 42, 44),] == 1).all() or \
                (arr[(9, 18, 31, 41),] == 1).all() or (arr[(9, 18, 31, 40, 44),] == 1).all() or (arr[(9, 18, 31, 39, 43),] == 1).all() or (arr[(9, 18, 31, 39, 42, 44),] == 1).all() or \
                (arr[(9, 18, 30, 38),] == 1).all() or (arr[(9, 18, 30, 37, 44),] == 1).all() or (arr[(9, 18, 30, 36, 43),] == 1).all() or (arr[(9, 18, 30, 36, 42, 44),] == 1).all() or \
                (arr[(9, 18, 30, 35, 41),] == 1).all() or (arr[(9, 18, 30, 35, 40, 44),] == 1).all() or (arr[(9, 18, 30, 35, 39, 43),] == 1).all() or (arr[(9, 18, 30, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 29),] == 1).all() or (arr[(9, 17, 28, 44),] == 1).all() or (arr[(9, 17, 27, 43),] == 1).all() or (arr[(9, 17, 27, 42, 44),] == 1).all() or \
                (arr[(9, 17, 26, 41),] == 1).all() or (arr[(9, 17, 26, 40, 44),] == 1).all() or (arr[(9, 17, 26, 39, 43),] == 1).all() or (arr[(9, 17, 26, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 25, 38),] == 1).all() or (arr[(9, 17, 25, 37, 44),] == 1).all() or (arr[(9, 17, 25, 36, 43),] == 1).all() or (arr[(9, 17, 25, 36, 42, 44),] == 1).all() or \
                (arr[(9, 17, 25, 35, 41),] == 1).all() or (arr[(9, 17, 25, 35, 40, 44),] == 1).all() or (arr[(9, 17, 25, 35, 39, 43),] == 1).all() or (arr[(9, 17, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 34),] == 1).all() or (arr[(9, 17, 24, 33, 44),] == 1).all() or (arr[(9, 17, 24, 32, 43),] == 1).all() or (arr[(9, 17, 24, 32, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 31, 41),] == 1).all() or (arr[(9, 17, 24, 31, 40, 44),] == 1).all() or (arr[(9, 17, 24, 31, 39, 43),] == 1).all() or (arr[(9, 17, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 30, 38),] == 1).all() or (arr[(9, 17, 24, 30, 37, 44),] == 1).all() or (arr[(9, 17, 24, 30, 36, 43),] == 1).all() or (arr[(9, 17, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 30, 35, 41),] == 1).all() or (arr[(9, 17, 24, 30, 35, 40, 44),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 43),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 42, 44),] == 1).all()
            )
        )
    ])


def synergetic_edge_loading(arr):
    return np.abs(arr)[:9] * np.array([
        0,
        (arr[(9),] == 1).sum(),
        (
            (arr[(10, 17),] == 1).sum() + \
            (arr[(9, 17),] == 1).all()
        ),
        (
            (arr[(11, 18, 24),] == 1).sum() + \
            (arr[(10, 24),] == 1).all() + (arr[(17, 24),] == 1).all() + \
            ((arr[(9, 18),] == 1).all() or (arr[(9, 17, 24),] == 1).all())
        ),
        (
            (arr[(12, 19, 25, 30),] == 1).sum() + \
            (arr[(11, 30),] == 1).all() + (arr[(18, 30),] == 1).all() + (arr[(24, 30),] == 1).all() + \
            ((arr[(10, 25),] == 1).all() or (arr[(10, 24, 30),] == 1).all()) + \
            ((arr[(17, 25),] == 1).all() or (arr[(17, 24, 30),] == 1).all()) + \
            ((arr[(9, 19),] == 1).all() or (arr[(9, 18, 30),] == 1).all() or (arr[(9, 17, 25),] == 1).all() or (arr[(9, 17, 24, 30),] == 1).all())
        ),
        (
            (arr[(13, 20, 26, 31, 35),] == 1).sum() + \
            (arr[(12, 35),] == 1).all() + (arr[(19, 35),] == 1).all() + (arr[(25, 35),] == 1).all() + (arr[(30, 35),] == 1).all() + \
            ((arr[(11, 31),] == 1).all() or (arr[(11, 30, 35),] == 1).all()) + \
            ((arr[(18, 31),] == 1).all() or (arr[(18, 30, 35),] == 1).all()) + \
            ((arr[(24, 31),] == 1).all() or (arr[(24, 30, 35),] == 1).all()) + \
            ((arr[(10, 26),] == 1).all() or (arr[(10, 25, 35),] == 1).all() or (arr[(10, 24, 31),] == 1).all() or (arr[(10, 24, 30, 35),] == 1).all()) + \
            ((arr[(17, 26),] == 1).all() or (arr[(17, 25, 35),] == 1).all() or (arr[(17, 24, 31),] == 1).all() or (arr[(17, 24, 30, 35),] == 1).all()) + \
            (
                (arr[(9, 20),] == 1).all() or (arr[(9, 19, 35),] == 1).all() or (arr[(9, 18, 31),] == 1).all() or (arr[(9, 18, 30, 35),] == 1).all() or \
                (arr[(9, 17, 26),] == 1).all() or (arr[(9, 17, 25, 35),] == 1).all() or (arr[(9, 17, 24, 31),] == 1).all() or (arr[(9, 17, 24, 30, 35),] == 1).all()
            )
        ),
        (
            (arr[(14, 21, 27, 32, 36, 39),] == 1).sum() + \
            (arr[(13, 39),] == 1).all() + (arr[(20, 39),] == 1).all() + (arr[(26, 39),] == 1).all() + (arr[(31, 39),] == 1).all() + (arr[(35, 39),] == 1).all() + \
            ((arr[(12, 36),] == 1).all() or (arr[(12, 35, 39),] == 1).all()) + \
            ((arr[(19, 36),] == 1).all() or (arr[(19, 35, 39),] == 1).all()) + \
            ((arr[(25, 36),] == 1).all() or (arr[(25, 35, 39),] == 1).all()) + \
            ((arr[(30, 36),] == 1).all() or (arr[(30, 35, 39),] == 1).all()) + \
            ((arr[(11, 32),] == 1).all() or (arr[(11, 31, 39),] == 1).all() or (arr[(11, 30, 36),] == 1).all() or (arr[(11, 30, 35, 39),] == 1).all()) + \
            ((arr[(18, 32),] == 1).all() or (arr[(18, 31, 39),] == 1).all() or (arr[(18, 30, 36),] == 1).all() or (arr[(18, 30, 35, 39),] == 1).all()) + \
            ((arr[(24, 32),] == 1).all() or (arr[(24, 31, 39),] == 1).all() or (arr[(24, 30, 36),] == 1).all() or (arr[(24, 30, 35, 39),] == 1).all()) + \
            (
                (arr[(10, 27),] == 1).all() or (arr[(10, 26, 39),] == 1).all() or (arr[(10, 25, 36),] == 1).all() or (arr[(10, 25, 35, 39),] == 1).all() or \
                (arr[(10, 24, 32),] == 1).all() or (arr[(10, 24, 31, 39),] == 1).all() or (arr[(10, 24, 30, 36),] == 1).all() or (arr[(10, 24, 30, 35, 39),] == 1).all()
            ) + \
            (
                (arr[(17, 27),] == 1).all() or (arr[(17, 26, 39),] == 1).all() or (arr[(17, 25, 36),] == 1).all() or (arr[(17, 25, 35, 39),] == 1).all() or \
                (arr[(17, 24, 32),] == 1).all() or (arr[(17, 24, 31, 39),] == 1).all() or (arr[(17, 24, 30, 36),] == 1).all() or (arr[(17, 24, 30, 35, 39),] == 1).all()
            ) + \
            (
                (arr[(9, 21),] == 1).all() or (arr[(9, 20, 39),] == 1).all() or (arr[(9, 19, 36),] == 1).all() or (arr[(9, 19, 35, 39),] == 1).all() or \
                (arr[(9, 18, 32),] == 1).all() or (arr[(9, 18, 31, 39),] == 1).all() or (arr[(9, 18, 30, 36),] == 1).all() or (arr[(9, 18, 30, 35, 39),] == 1).all() or \
                (arr[(9, 17, 27),] == 1).all() or (arr[(9, 17, 26, 39),] == 1).all() or (arr[(9, 17, 25, 36),] == 1).all() or (arr[(9, 17, 25, 35, 39),] == 1).all() or \
                (arr[(9, 17, 24, 32),] == 1).all() or (arr[(9, 17, 24, 31, 39),] == 1).all() or (arr[(9, 17, 24, 30, 36),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39),] == 1).all()
            )
        ),
        (
            (arr[(15, 22, 28, 33, 37, 40, 42),] == 1).sum() + \
            (arr[(14, 42),] == 1).all() + (arr[(21, 42),] == 1).all() + (arr[(27, 42),] == 1).all() + (arr[(32, 42),] == 1).all() + (arr[(36, 42),] == 1).all() + (arr[(39, 42),] == 1).all() + \
            ((arr[(13, 40),] == 1).all() or (arr[(13, 39, 42),] == 1).all()) + \
            ((arr[(20, 40),] == 1).all() or (arr[(20, 39, 42),] == 1).all()) + \
            ((arr[(26, 40),] == 1).all() or (arr[(26, 39, 42),] == 1).all()) + \
            ((arr[(31, 40),] == 1).all() or (arr[(31, 39, 42),] == 1).all()) + \
            ((arr[(35, 40),] == 1).all() or (arr[(35, 39, 42),] == 1).all()) + \
            ((arr[(12, 37),] == 1).all() or (arr[(12, 36, 42),] == 1).all() or (arr[(12, 35, 40),] == 1).all() or (arr[(12, 35, 39, 42),] == 1).all()) + \
            ((arr[(19, 37),] == 1).all() or (arr[(19, 36, 42),] == 1).all() or (arr[(19, 35, 40),] == 1).all() or (arr[(19, 35, 39, 42),] == 1).all()) + \
            ((arr[(25, 37),] == 1).all() or (arr[(25, 36, 42),] == 1).all() or (arr[(25, 35, 40),] == 1).all() or (arr[(25, 35, 39, 42),] == 1).all()) + \
            ((arr[(30, 37),] == 1).all() or (arr[(30, 36, 42),] == 1).all() or (arr[(30, 35, 40),] == 1).all() or (arr[(30, 35, 39, 42),] == 1).all()) + \
            (
                (arr[(11, 33),] == 1).all() or (arr[(11, 32, 42),] == 1).all() or (arr[(11, 31, 40),] == 1).all() or (arr[(11, 31, 39, 42),] == 1).all() or \
                (arr[(11, 30, 37),] == 1).all() or (arr[(11, 30, 36, 42),] == 1).all() or (arr[(11, 30, 35, 40),] == 1).all() or (arr[(11, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(18, 33),] == 1).all() or (arr[(18, 32, 42),] == 1).all() or (arr[(18, 31, 40),] == 1).all() or (arr[(18, 31, 39, 42),] == 1).all() or \
                (arr[(18, 30, 37),] == 1).all() or (arr[(18, 30, 36, 42),] == 1).all() or (arr[(18, 30, 35, 40),] == 1).all() or (arr[(18, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(24, 33),] == 1).all() or (arr[(24, 32, 42),] == 1).all() or (arr[(24, 31, 40),] == 1).all() or (arr[(24, 31, 39, 42),] == 1).all() or \
                (arr[(24, 30, 37),] == 1).all() or (arr[(24, 30, 36, 42),] == 1).all() or (arr[(24, 30, 35, 40),] == 1).all() or (arr[(24, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(10, 28),] == 1).all() or (arr[(10, 27, 42),] == 1).all() or (arr[(10, 26, 40),] == 1).all() or (arr[(10, 26, 39, 42),] == 1).all() or \
                (arr[(10, 25, 37),] == 1).all() or (arr[(10, 25, 36, 42),] == 1).all() or (arr[(10, 25, 35, 40),] == 1).all() or (arr[(10, 25, 35, 39, 42),] == 1).all() or \
                (arr[(10, 24, 33),] == 1).all() or (arr[(10, 24, 32, 42),] == 1).all() or (arr[(10, 24, 31, 40),] == 1).all() or (arr[(10, 24, 31, 39, 42),] == 1).all() or \
                (arr[(10, 24, 30, 37),] == 1).all() or (arr[(10, 24, 30, 36, 42),] == 1).all() or (arr[(10, 24, 30, 35, 40),] == 1).all() or (arr[(10, 24, 30, 35, 39, 42),] == 1).all()
            ) + \
             (
                (arr[(17, 28),] == 1).all() or (arr[(17, 27, 42),] == 1).all() or (arr[(17, 26, 40),] == 1).all() or (arr[(17, 26, 39, 42),] == 1).all() or \
                (arr[(17, 25, 37),] == 1).all() or (arr[(17, 25, 36, 42),] == 1).all() or (arr[(17, 25, 35, 40),] == 1).all() or (arr[(17, 25, 35, 39, 42),] == 1).all() or \
                (arr[(17, 24, 33),] == 1).all() or (arr[(17, 24, 32, 42),] == 1).all() or (arr[(17, 24, 31, 40),] == 1).all() or (arr[(17, 24, 31, 39, 42),] == 1).all() or \
                (arr[(17, 24, 30, 37),] == 1).all() or (arr[(17, 24, 30, 36, 42),] == 1).all() or (arr[(17, 24, 30, 35, 40),] == 1).all() or (arr[(17, 24, 30, 35, 39, 42),] == 1).all()
            ) + \
            (
                (arr[(9, 22),] == 1).all() or (arr[(9, 21, 42),] == 1).all() or (arr[(9, 20, 40),] == 1).all() or (arr[(9, 20, 39, 42),] == 1).all() or \
                (arr[(9, 19, 37),] == 1).all() or (arr[(9, 19, 36, 42),] == 1).all() or (arr[(9, 19, 35, 40),] == 1).all() or (arr[(9, 19, 35, 39, 42),] == 1).all() or \
                (arr[(9, 18, 33),] == 1).all() or (arr[(9, 18, 32, 42),] == 1).all() or (arr[(9, 18, 31, 40),] == 1).all() or (arr[(9, 18, 31, 39, 42),] == 1).all() or \
                (arr[(9, 18, 30, 37),] == 1).all() or (arr[(9, 18, 30, 36, 42),] == 1).all() or (arr[(9, 18, 30, 35, 40),] == 1).all() or (arr[(9, 18, 30, 35, 39, 42),] == 1).all() or \
                (arr[(9, 17, 28),] == 1).all() or (arr[(9, 17, 27, 42),] == 1).all() or (arr[(9, 17, 26, 40),] == 1).all() or (arr[(9, 17, 26, 39, 42),] == 1).all() or \
                (arr[(9, 17, 25, 37),] == 1).all() or (arr[(9, 17, 25, 36, 42),] == 1).all() or (arr[(9, 17, 25, 35, 40),] == 1).all() or (arr[(9, 17, 25, 35, 39, 42),] == 1).all() or \
                (arr[(9, 17, 24, 33),] == 1).all() or (arr[(9, 17, 24, 32, 42),] == 1).all() or (arr[(9, 17, 24, 31, 40),] == 1).all() or (arr[(9, 17, 24, 31, 39, 42),] == 1).all() or \
                (arr[(9, 17, 24, 30, 37),] == 1).all() or (arr[(9, 17, 24, 30, 36, 42),] == 1).all() or (arr[(9, 17, 24, 30, 35, 40),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 42),] == 1).all()
            )
        ),
        (
            (arr[(16, 23, 29, 34, 38, 41, 43, 44),] == 1).sum() + \
            (arr[(15, 44),] == 1).all() + (arr[(22, 44),] == 1).all() + (arr[(28, 44),] == 1).all() + (arr[(33, 44),] == 1).all() + \
            (arr[(37, 44),] == 1).all() + (arr[(40, 44),] == 1).all() + (arr[(42, 44),] == 1).all() + \
            ((arr[(14, 43),] == 1).all() or (arr[(14, 42, 44),] == 1).all()) + \
            ((arr[(21, 43),] == 1).all() or (arr[(21, 42, 44),] == 1).all()) + \
            ((arr[(27, 43),] == 1).all() or (arr[(27, 42, 44),] == 1).all()) + \
            ((arr[(32, 43),] == 1).all() or (arr[(32, 42, 44),] == 1).all()) + \
            ((arr[(36, 43),] == 1).all() or (arr[(36, 42, 44),] == 1).all()) + \
            ((arr[(39, 43),] == 1).all() or (arr[(39, 42, 44),] == 1).all()) + \
            ((arr[(13, 41),] == 1).all() or (arr[(13, 40, 44),] == 1).all() or (arr[(13, 39, 43),] == 1).all() or (arr[(13, 39, 42, 44),] == 1).all()) + \
            ((arr[(20, 41),] == 1).all() or (arr[(20, 40, 44),] == 1).all() or (arr[(20, 39, 43),] == 1).all() or (arr[(20, 39, 42, 44),] == 1).all()) + \
            ((arr[(26, 41),] == 1).all() or (arr[(26, 40, 44),] == 1).all() or (arr[(26, 39, 43),] == 1).all() or (arr[(26, 39, 42, 44),] == 1).all()) + \
            ((arr[(31, 41),] == 1).all() or (arr[(31, 40, 44),] == 1).all() or (arr[(31, 39, 43),] == 1).all() or (arr[(31, 39, 42, 44),] == 1).all()) + \
            ((arr[(35, 41),] == 1).all() or (arr[(35, 40, 44),] == 1).all() or (arr[(35, 39, 43),] == 1).all() or (arr[(35, 39, 42, 44),] == 1).all()) + \
            (
                (arr[(12, 38),] == 1).all() or (arr[(12, 37, 44),] == 1).all() or (arr[(12, 36, 43),] == 1).all() or (arr[(12, 36, 42, 44),] == 1).all() or \
                (arr[(12, 35, 41),] == 1).all() or (arr[(12, 35, 40, 44),] == 1).all() or (arr[(12, 35, 39, 43),] == 1).all() or (arr[(12, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(19, 38),] == 1).all() or (arr[(19, 37, 44),] == 1).all() or (arr[(19, 36, 43),] == 1).all() or (arr[(19, 36, 42, 44),] == 1).all() or \
                (arr[(19, 35, 41),] == 1).all() or (arr[(19, 35, 40, 44),] == 1).all() or (arr[(19, 35, 39, 43),] == 1).all() or (arr[(19, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(25, 38),] == 1).all() or (arr[(25, 37, 44),] == 1).all() or (arr[(25, 36, 43),] == 1).all() or (arr[(25, 36, 42, 44),] == 1).all() or \
                (arr[(25, 35, 41),] == 1).all() or (arr[(25, 35, 40, 44),] == 1).all() or (arr[(25, 35, 39, 43),] == 1).all() or (arr[(25, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(30, 38),] == 1).all() or (arr[(30, 37, 44),] == 1).all() or (arr[(30, 36, 43),] == 1).all() or (arr[(30, 36, 42, 44),] == 1).all() or \
                (arr[(30, 35, 41),] == 1).all() or (arr[(30, 35, 40, 44),] == 1).all() or (arr[(30, 35, 39, 43),] == 1).all() or (arr[(30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(11, 34),] == 1).all() or (arr[(11, 33, 44),] == 1).all() or (arr[(11, 32, 43),] == 1).all() or (arr[(11, 32, 42, 44),] == 1).all() or \
                (arr[(11, 31, 41),] == 1).all() or (arr[(11, 31, 40, 44),] == 1).all() or (arr[(11, 31, 39, 43),] == 1).all() or (arr[(11, 31, 39, 42, 44),] == 1).all() or \
                (arr[(11, 30, 38),] == 1).all() or (arr[(11, 30, 37, 44),] == 1).all() or (arr[(11, 30, 36, 43),] == 1).all() or (arr[(11, 30, 36, 42, 44),] == 1).all() or \
                (arr[(11, 30, 35, 41),] == 1).all() or (arr[(11, 30, 35, 40, 44),] == 1).all() or (arr[(11, 30, 35, 39, 43),] == 1).all() or (arr[(11, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(18, 34),] == 1).all() or (arr[(18, 33, 44),] == 1).all() or (arr[(18, 32, 43),] == 1).all() or (arr[(18, 32, 42, 44),] == 1).all() or \
                (arr[(18, 31, 41),] == 1).all() or (arr[(18, 31, 40, 44),] == 1).all() or (arr[(18, 31, 39, 43),] == 1).all() or (arr[(18, 31, 39, 42, 44),] == 1).all() or \
                (arr[(18, 30, 38),] == 1).all() or (arr[(18, 30, 37, 44),] == 1).all() or (arr[(18, 30, 36, 43),] == 1).all() or (arr[(18, 30, 36, 42, 44),] == 1).all() or \
                (arr[(18, 30, 35, 41),] == 1).all() or (arr[(18, 30, 35, 40, 44),] == 1).all() or (arr[(18, 30, 35, 39, 43),] == 1).all() or (arr[(18, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(24, 34),] == 1).all() or (arr[(24, 33, 44),] == 1).all() or (arr[(24, 32, 43),] == 1).all() or (arr[(24, 32, 42, 44),] == 1).all() or \
                (arr[(24, 31, 41),] == 1).all() or (arr[(24, 31, 40, 44),] == 1).all() or (arr[(24, 31, 39, 43),] == 1).all() or (arr[(24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(24, 30, 38),] == 1).all() or (arr[(24, 30, 37, 44),] == 1).all() or (arr[(24, 30, 36, 43),] == 1).all() or (arr[(24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(24, 30, 35, 41),] == 1).all() or (arr[(24, 30, 35, 40, 44),] == 1).all() or (arr[(24, 30, 35, 39, 43),] == 1).all() or (arr[(24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(10, 29),] == 1).all() or (arr[(10, 28, 44),] == 1).all() or (arr[(10, 27, 43),] == 1).all() or (arr[(10, 27, 42, 44),] == 1).all() or \
                (arr[(10, 26, 41),] == 1).all() or (arr[(10, 26, 40, 44),] == 1).all() or (arr[(10, 26, 39, 43),] == 1).all() or (arr[(10, 26, 39, 42, 44),] == 1).all() or \
                (arr[(10, 25, 38),] == 1).all() or (arr[(10, 25, 37, 44),] == 1).all() or (arr[(10, 25, 36, 43),] == 1).all() or (arr[(10, 25, 36, 42, 44),] == 1).all() or \
                (arr[(10, 25, 35, 41),] == 1).all() or (arr[(10, 25, 35, 40, 44),] == 1).all() or (arr[(10, 25, 35, 39, 43),] == 1).all() or (arr[(10, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(10, 24, 34),] == 1).all() or (arr[(10, 24, 33, 44),] == 1).all() or (arr[(10, 24, 32, 43),] == 1).all() or (arr[(10, 24, 32, 42, 44),] == 1).all() or \
                (arr[(10, 24, 31, 41),] == 1).all() or (arr[(10, 24, 31, 40, 44),] == 1).all() or (arr[(10, 24, 31, 39, 43),] == 1).all() or (arr[(10, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(10, 24, 30, 38),] == 1).all() or (arr[(10, 24, 30, 37, 44),] == 1).all() or (arr[(10, 24, 30, 36, 43),] == 1).all() or (arr[(10, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(10, 24, 30, 35, 41),] == 1).all() or (arr[(10, 24, 30, 35, 40, 44),] == 1).all() or (arr[(10, 24, 30, 35, 39, 43),] == 1).all() or (arr[(10, 24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(17, 29),] == 1).all() or (arr[(17, 28, 44),] == 1).all() or (arr[(17, 27, 43),] == 1).all() or (arr[(17, 27, 42, 44),] == 1).all() or \
                (arr[(17, 26, 41),] == 1).all() or (arr[(17, 26, 40, 44),] == 1).all() or (arr[(17, 26, 39, 43),] == 1).all() or (arr[(17, 26, 39, 42, 44),] == 1).all() or \
                (arr[(17, 25, 38),] == 1).all() or (arr[(17, 25, 37, 44),] == 1).all() or (arr[(17, 25, 36, 43),] == 1).all() or (arr[(17, 25, 36, 42, 44),] == 1).all() or \
                (arr[(17, 25, 35, 41),] == 1).all() or (arr[(17, 25, 35, 40, 44),] == 1).all() or (arr[(17, 25, 35, 39, 43),] == 1).all() or (arr[(17, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(17, 24, 34),] == 1).all() or (arr[(17, 24, 33, 44),] == 1).all() or (arr[(17, 24, 32, 43),] == 1).all() or (arr[(17, 24, 32, 42, 44),] == 1).all() or \
                (arr[(17, 24, 31, 41),] == 1).all() or (arr[(17, 24, 31, 40, 44),] == 1).all() or (arr[(17, 24, 31, 39, 43),] == 1).all() or (arr[(17, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(17, 24, 30, 38),] == 1).all() or (arr[(17, 24, 30, 37, 44),] == 1).all() or (arr[(17, 24, 30, 36, 43),] == 1).all() or (arr[(17, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(17, 24, 30, 35, 41),] == 1).all() or (arr[(17, 24, 30, 35, 40, 44),] == 1).all() or (arr[(17, 24, 30, 35, 39, 43),] == 1).all() or (arr[(17, 24, 30, 35, 39, 42, 44),] == 1).all()
            ) + \
            (
                (arr[(9, 23),] == 1).all() or (arr[(9, 22, 44),] == 1).all() or (arr[(9, 21, 43),] == 1).all() or (arr[(9, 21, 42, 44),] == 1).all() or \
                (arr[(9, 20, 41),] == 1).all() or (arr[(9, 20, 40, 44),] == 1).all() or (arr[(9, 20, 39, 43),] == 1).all() or (arr[(9, 20, 39, 42, 44),] == 1).all() or \
                (arr[(9, 19, 38),] == 1).all() or (arr[(9, 19, 37, 44),] == 1).all() or (arr[(9, 19, 36, 43),] == 1).all() or (arr[(9, 19, 36, 42, 44),] == 1).all() or \
                (arr[(9, 19, 35, 41),] == 1).all() or (arr[(9, 19, 35, 40, 44),] == 1).all() or (arr[(9, 19, 35, 39, 43),] == 1).all() or (arr[(9, 19, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 18, 34),] == 1).all() or (arr[(9, 18, 33, 44),] == 1).all() or (arr[(9, 18, 32, 43),] == 1).all() or (arr[(9, 18, 32, 42, 44),] == 1).all() or \
                (arr[(9, 18, 31, 41),] == 1).all() or (arr[(9, 18, 31, 40, 44),] == 1).all() or (arr[(9, 18, 31, 39, 43),] == 1).all() or (arr[(9, 18, 31, 39, 42, 44),] == 1).all() or \
                (arr[(9, 18, 30, 38),] == 1).all() or (arr[(9, 18, 30, 37, 44),] == 1).all() or (arr[(9, 18, 30, 36, 43),] == 1).all() or (arr[(9, 18, 30, 36, 42, 44),] == 1).all() or \
                (arr[(9, 18, 30, 35, 41),] == 1).all() or (arr[(9, 18, 30, 35, 40, 44),] == 1).all() or (arr[(9, 18, 30, 35, 39, 43),] == 1).all() or (arr[(9, 18, 30, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 29),] == 1).all() or (arr[(9, 17, 28, 44),] == 1).all() or (arr[(9, 17, 27, 43),] == 1).all() or (arr[(9, 17, 27, 42, 44),] == 1).all() or \
                (arr[(9, 17, 26, 41),] == 1).all() or (arr[(9, 17, 26, 40, 44),] == 1).all() or (arr[(9, 17, 26, 39, 43),] == 1).all() or (arr[(9, 17, 26, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 25, 38),] == 1).all() or (arr[(9, 17, 25, 37, 44),] == 1).all() or (arr[(9, 17, 25, 36, 43),] == 1).all() or (arr[(9, 17, 25, 36, 42, 44),] == 1).all() or \
                (arr[(9, 17, 25, 35, 41),] == 1).all() or (arr[(9, 17, 25, 35, 40, 44),] == 1).all() or (arr[(9, 17, 25, 35, 39, 43),] == 1).all() or (arr[(9, 17, 25, 35, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 34),] == 1).all() or (arr[(9, 17, 24, 33, 44),] == 1).all() or (arr[(9, 17, 24, 32, 43),] == 1).all() or (arr[(9, 17, 24, 32, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 31, 41),] == 1).all() or (arr[(9, 17, 24, 31, 40, 44),] == 1).all() or (arr[(9, 17, 24, 31, 39, 43),] == 1).all() or (arr[(9, 17, 24, 31, 39, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 30, 38),] == 1).all() or (arr[(9, 17, 24, 30, 37, 44),] == 1).all() or (arr[(9, 17, 24, 30, 36, 43),] == 1).all() or (arr[(9, 17, 24, 30, 36, 42, 44),] == 1).all() or \
                (arr[(9, 17, 24, 30, 35, 41),] == 1).all() or (arr[(9, 17, 24, 30, 35, 40, 44),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 43),] == 1).all() or (arr[(9, 17, 24, 30, 35, 39, 42, 44),] == 1).all()
            )
        )
    ])


def max_positive_edge_density(arr):
    return positive_edge_loading(arr).max() / n_eff(arr) if n_eff(arr) != 0 else 0


def mean_positive_edge_density(arr):
    n_factor = arr[:9].size
    theoretical = n_factor * (n_factor + 1) * (n_factor - 1) / 6
    return positive_edge_loading(arr).sum() / theoretical if theoretical != 0 else 0


def max_synergetic_edge_density(arr):
    return synergetic_edge_loading(arr).max() / n_eff(arr) if n_eff(arr) != 0 else 0


def cai(arr) -> float:
    return harmonic_mean(
        edge_coverage(arr),
        sparse_pathway_coverage(arr),
        max_positive_edge_density(arr)
    )


def pbsi(arr) -> float:
    return np.mean([
        positive_pathway_coverage(arr),
        1 - max_positive_edge_density(arr),
        1 - mean_positive_edge_density(arr)
    ])


feat_names_short = dict(
    pathway_coverage=r"P%",
    pathway_positivity=r"P$_{(+)}$/P",
    pathway_negativity=r"P$_{(-)}$/P",
    positive_pathway_coverage=r"P$_{(+)}$%",
    negative_pathway_coverage=r"P$_{(-)}$%",
    sparse_pathway_coverage=r"P$_{(0)}$%",
    edge_coverage=r"R%",
    edge_positivity=r"R$_{(+)}$/R",
    edge_negativity=r"R$_{(-)}$/R",
    positive_edge_coverage=r"R$_{(+)}$%",
    negative_edge_coverage=r"R$_{(-)}$%",
    sparse_edge_coverage=r"R$_{(0)}$%",
    edge_effectivity=r"R$^*$/R",
    effective_edge_positivity=r"R$^*_{(+)}$/R$^*$",
    effective_edge_negativity=r"R$^*_{(-)}$/R$^*$",
    max_edge_density=r"MaxRW/R$^*$",
    mean_edge_density=r"RW%",
    max_positive_edge_density=r"MaxRW$_{(+)}$/R$^*$",
    mean_positive_edge_density=r"RW$_{(+)}$%",
    max_synergetic_edge_density=r"MaxRW$_&$/R$^*$",
    mean_synergetic_edge_density=r"RW$_&$%",
    max_factor_density=r"MaxFW/n",
    mean_factor_density=r"FW%",
    max_positive_factor_density=r"MaxFW$_{(+)}$/n",
    mean_positive_factor_density=r"FW$_{(+)}$%",
    max_synergetic_factor_density=r"MaxFW$_&$/n",
    mean_synergetic_factor_density=r"FW$_&$%",
    max_cascade_length_ratio=r"MaxCL/n",
    mean_cascade_length_ratio=r"CL%",
    max_positive_cascade_length_ratio=r"MaxCL$_{(+)}$/n",
    mean_positive_cascade_length_ratio=r"CL$_{(+)}$%",
    max_synergetic_cascade_length_ratio=r"MaxCL$_&$/n",
    mean_synergetic_cascade_length_ratio=r"CL$_&$%"
)